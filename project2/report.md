<h2  align = "center" >人工智能基础<br>第二次大作业报告 </h2>

<h6 align = "center">自96 曲世远 2019011455</h6>

### 0.使用说明

#### 0.1 UI使用说明



### 1.训练及评估

#### 1.1模型及训练设计

​	本大作业的第一问要求针对一个表情数据集进行七分类的模型训练，为了获得较好的训练效果，我主要从以下两个方面进行了特殊设计：

1. 首先是数据的预处理方面，我采用了

#### 1.2**模拟对战游戏模式下的算法设计**

​	本部分的算法主要分为应对出牌与主动出牌两部分：

​	应对出牌部分只需要考虑自己的牌中是否有相同类型的出牌方式，如果搜索到有，则出相同类型中最小的一个即可；

​	主动出牌的情况中我复用了单人模式中的搜索最快出牌的方式，我算法的逻辑是，如果我可以主动出牌，那么搜索如何我自己才能最快的将一副牌出完，在这种情况下挑选最有价值的出牌方式优先出。

​	基于以上的逻辑，我实现了比较有效的模拟对战策略。

### 2.算法效率分析

为了有更加直观的比较结论，我主要针对本次作业的第一小问（第一小问与第二小问的算法设计区别不大，而第二小问验证难度稍大，故采用第一小问验证效率）进行算效率验证。

为了更直观的进行比较，我主要与完全DFS搜索的效率进行比较：

【比较方式为进行随机500-1000iters的出牌方式搜索计算，通过tqdm模块获取平均的搜索时间】

下图为**完全DFS算法**对于手牌数量为16, 17, 18, 19,  20张时的运行效率，可以发现完全DFS算法在20张牌左右进行运算时，平均计算时间随手牌数的增长呈现指数次的增长，而在20张牌以上的情况时，这种增长速度进一步提高，大概在25张手牌左右时，就会出现$min/iter$的计算时间，基本无法在短时间内解决30张手牌以上的问题。

分析这一现象的原因，主要是由于一幅手牌共有15种牌，而在手牌数量达到15张以上时，顺子的出现几率随牌数的增加大幅提高，从而导致了分支因子的陡然增大。而在25张牌以上时，双顺子与各种带牌的情况变得更加复杂，分支因子呈现爆炸性增长，完全DFS无法处理如此高的分支因子带来的复杂性。

<img src="report.assets/91dc24fbd1911e888d6b60e8f1ebf36.png" alt="91dc24fbd1911e888d6b60e8f1ebf36" style="zoom:80%;" />

而对于应用了DP剪枝的DFS算法（即我采用的算法），可以轻松的应付25张手牌以下的问题：

<img src="report.assets/image-20211104222048051.png" alt="image-20211104222048051" style="zoom:80%;" />

然而在计算运行中我也观察到其出现的偶尔卡顿现象，究其原因是由于部分随机出的牌型具有对于顺子来说较大的分支因子，如连续码数都具有的多张手牌，由于我的顺子部分的搜索仍旧采用的是DFS搜索方式，因而在处理此类情况时效率仍旧较低。

